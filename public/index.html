
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Protonik Hydrogen Dashboard</title>
    
    <link rel="icon" type="image/x-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>âš¡</text></svg>">
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link rel="preconnect" href="https://api.weatherapi.com" />
    <link rel="preconnect" href="https://159.69.192.158" />
    

    <link rel="stylesheet" href="css/styles.css" />
    

    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100..900;1,100..900&display=swap"
      rel="stylesheet"
    />

    <script defer src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom@1.0.0"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/luxon"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/chartjs-adapter-luxon"></script>
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/gsap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/ScrollTrigger.min.js"></script>


    <script type="module" defer src="/js/simulation.js"></script>
    <script type="module" defer src="/js/main.js"></script>

  </head>
  <body>
    <div id="flowchart-panel">
      <div class="flowchart">
        <div class="flowchart-title"><span class="live-dot"></span>Live Simulation</div>
        <div class="flow-item">
          <img src="/icons/photovoltaik.webp" alt="Photovoltaik" />
          <p>Photovoltaik</p>
        </div>
        <div id="pv-charging-arrow">
          <img id="pv-static-arrow" src="/icons/arrow.webp" alt="Charging Arrow" />
          <img id="pv-animated-arrow" src="/icons/arrowanim.gif" alt="Charging Animation" />
        </div>
        <div class="flow-item">
          <img src="/icons/battery.webp" alt="Battery" />
          <p>Battery</p>
        </div>
        <div id="electrolyzer-charging-arrow">
          <img id="electrolyzer-static-arrow" src="/icons/arrow.webp" alt="Charging Arrow" />
          <img id="electrolyzer-animated-arrow" src="/icons/arrowanim.gif" alt="Charging Animation" />
        </div>
        <div class="flow-item">
          <img src="/icons/electrolyzer.webp" alt="Electrolyzer" />
          <p>Electrolyzer</p>
        </div>
        <div id="electrolyzer-output-charging-arrow">
          <img id="electrolyzer-output-static-arrow" src="/icons/arrow.webp" alt="Charging Arrow" />
          <img id="electrolyzer-output-animated-arrow" src="/icons/arrowanim.gif" alt="Charging Animation" />
        </div>
        <div class="flow-item">
          <img src="/icons/hydrogenstorage.webp" alt="Hydrogen Storage" />
          <p>Hydrogen Storage</p>
        </div>
        <div id="fuelcell-charging-arrow">
          <img id="fuelcell-static-arrow" src="/icons/arrow.webp" alt="Charging Arrow" />
          <img id="fuelcell-animated-arrow" src="/icons/arrowanim.gif" alt="Charging Animation" />
        </div>
        <div class="flow-item">
          <img src="/icons/fuelcell.webp" alt="Fuel Cell" />
          <p>Fuel Cell</p>
        </div>
        <div id="fuelcell-to-charging-charging-arrow">
          <img id="fuelcell-to-charging-static-arrow" src="/icons/arrow.webp" alt="Charging Arrow" />
          <img id="fuelcell-to-charging-animated-arrow" src="/icons/arrowanim.gif" alt="Charging Animation" />
        </div>
        <div class="flow-item">
          <img src="/icons/charging-station.webp" alt="Charging Station" />
          <p>Charging Station</p>
        </div>
        <!-- Subrow for expanded flowchart content (hidden until expanded) -->
        <div class="flow-subrow" id="flowchart-subrow" style="display:none;width:100%;justify-content:center;gap:48px;margin-top:12px;">
          <!-- EV charge under Electrolyzer -->
          <div class="flow-subitem" id="flow-ev-block" style="display:flex;align-items:center;gap:32px;flex-direction:row;">
            <!-- battery icon to the left of EV arrow -->
            <div id="ev-left-battery" style="display:flex;flex-direction:column;align-items:center;margin-right:6px;">
              <img id="ev-left-battery-icon" src="/icons/battery.webp" alt="Battery" style="width:54px;height:auto;" />
              <div>Battery</div>
            </div>
            <div id="electrolyzer-to-ev-arrow" style="display:flex;flex-direction:column;align-items:center;">
              <img id="electrolyzer-to-ev-static-arrow" src="/icons/arrow.webp" alt="->" style="width:40px;" />
              <img id="electrolyzer-to-ev-animated-arrow" src="/icons/arrowanim.gif" alt="anim" style="width:40px;display:none;" />
            </div>
            <div style="display:flex;flex-direction:column;align-items:center;">
              <img id="ev-charge-icon" src="/icons/charging-station.webp" alt="EV Charge" style="width:54px;height:auto;" />
              <div style="font-size:12px;margin-top:4px;">EV Charge</div>
            </div>
          </div>

          <!-- H2 charging station under Fuel Cell -->
          <div class="flow-subitem" id="flow-h2-block" style="display:flex;align-items:center;gap:32px;flex-direction:row;">
            <!-- hydrogen storage icon to the left of H2 arrow -->
            <div id="h2-left-storage" style="display:flex;flex-direction:column;align-items:center;margin-right:6px;">
              <img id="h2-left-storage-icon" src="/icons/hydrogenstorage.webp" alt="Hydrogen Storage" style="width:54px;height:auto;" />
              <div>Hydrogen Storage</div>
            </div>
            <div id="fuelcell-to-h2-arrow" style="display:flex;flex-direction:column;align-items:center;">
              <img id="fuelcell-to-h2-static-arrow" src="/icons/arrow.webp" alt="->" style="width:40px;" />
              <img id="fuelcell-to-h2-animated-arrow" src="/icons/arrowanim.gif" alt="anim" style="width:40px;display:none;" />
            </div>
            <div style="display:flex;flex-direction:column;align-items:center;">
              <img id="h2-charge-icon" src="/icons/hydrogenchargingstation.webp" alt="H2 Charge" style="width:54px;height:auto;" />
              <div style="font-size:12px;margin-top:4px;">H2 Charge</div>
            </div>
          </div>
        </div>
        <!-- Expand toggle: bottom centered arrow -->
        <button id="flowchart-toggle" aria-expanded="false" title="Expand flowchart" style="position:absolute;left:50%;transform:translateX(-50%);bottom:6px;width:36px;height:28px;border-radius:6px;border:none;background:#1976d2;color:#fff;cursor:pointer;box-shadow:0 2px 6px rgba(0,0,0,0.12);">â–¼</button>
      </div>
    </div>
    <div id="corner-widget" class="widget-card">
      <button id="toggle-widget">â–²</button>
      <div id="code-minimized">
        <div id="corner-content">
          <div class="gauge-container">

            <!-- Battery Level Gauge -->
            <div class="svg-gauge-wrapper" style="display: flex; flex-direction: column; align-items: center;">
              <svg id="battery-gauge" width="140" height="80" viewBox="0 0 140 80" style="display: block;">
                <path d="M 20 70 A 50 50 0 0 1 120 70" fill="none" stroke="#e0e0e0" stroke-width="12" />
                <path id="battery-gauge-fill" d="M 20 70 A 50 50 0 0 1 120 70" fill="none" stroke="#2ecc40" stroke-width="12" stroke-linecap="round" stroke-dasharray="157" stroke-dashoffset="157" />
              </svg>
              <div style="display: flex; flex-direction: column; align-items: center; margin-top: -40px;">
                <img src="/icons/newbattery.webp" alt="Battery Icon" style="width:38px;height:38px;object-fit:contain;" />
                <div id="battery-gauge-percentage" style="font-size: 18px; color: #222; font-weight: bold; text-align:center;">0 %</div>
              </div>
              <div style="margin-top: 2px; font-size: 15px; color: #222; font-weight: 500;">Battery</div>
            </div>

            <!-- Hydrogen Level Gauge -->
              <div id="hydrogen-svg-gauge" class="svg-gauge-wrapper" style="display: flex; flex-direction: column; align-items: center;">
                <svg width="140" height="80" viewBox="0 0 140 80" style="display: block;">
                  <path id="hydrogen-gauge-bg" d="M 20 70 A 50 50 0 0 1 120 70" fill="none" stroke="#e0e0e0" stroke-width="12" />
                  <path id="hydrogen-gauge-fill" d="M 20 70 A 50 50 0 0 1 120 70" fill="none" stroke="#00bcd4" stroke-width="12" stroke-linecap="round" stroke-dasharray="157" stroke-dashoffset="157" />
                </svg>
                <div style="display: flex; flex-direction: column; align-items: center; margin-top: -40px;">
                  <img src="/icons/newhydro.webp" alt="Hydrogen Icon" style="width:38px;height:38px;object-fit:contain;" />
                  <div id="hydrogen-gauge-percentage" style="font-size: 18px; color: #222; font-weight: bold; text-align:center;">0 %</div>
                </div>
                <div style="margin-top: 2px; font-size: 15px; color: #222; font-weight: 500;">Hydrogen</div>
              </div>
              <!-- Thermal Storage Gauge removed from code-minimized (now only in sticky bar) -->
          </div>
          <div class="mode-container">
            <h3>Simulation Mode:</h3>
            <p id="simulation-state"></p>
            
            <!-- Price container -->
            <div id="price-container">
              <p>Electricity Price: <span id="current-price"></span> â‚¬/MWh</p>
            </div>
            <div id="co2-container">
              <p>COâ‚‚ Emission: <span id="carbon-intensity"></span></p>
            </div>
          </div>

        </div>
      </div>
      <div id="code-expanded" style="display: none">

        <div class="sticky-bar" style="display: flex; justify-content: space-between; align-items: center; gap: 10px; top: 0; z-index: 101;">
          <div style="display: flex; align-items: center;">
            <button id="toggle-widget-expanded" class="toggle-widget">â–²</button>
          </div>
          <div class="sticky-bar-inner" style="display: flex; align-items: center; gap: 18px;">
            <!-- Sticky Bar Battery Gauge -->
            <div id="sticky-battery-gauge" style="display: flex; flex-direction: column; align-items: center; margin-right: 2px;">
              <svg id="sticky-battery-gauge-svg" width="126" height="72" viewBox="0 0 140 80" style="display: block;">
                <path d="M 20 70 A 50 50 0 0 1 120 70" fill="none" stroke="#e0e0e0" stroke-width="12" />
                <path id="sticky-battery-gauge-fill" d="M 20 70 A 50 50 0 0 1 120 70" fill="none" stroke="#2ecc40" stroke-width="12" stroke-linecap="round" stroke-dasharray="157" stroke-dashoffset="157" />
              </svg>
              <div style="display: flex; flex-direction: column; align-items: center; margin-top: -40px;">
                <img src="/icons/newbattery.webp" alt="Battery Icon" style="width:34px;height:34px;object-fit:contain;" />
                <div id="sticky-battery-gauge-percentage" style="font-size: 16px; color: #222; font-weight: bold; text-align:center;">0 %</div>
              </div>
              <div style="margin-top: 2px; font-size: 15px; color: #222; font-weight: 500;">Battery</div>
            </div>
            <!-- Sticky Bar Hydrogen Gauge -->
            <div id="sticky-hydrogen-gauge" style="display: flex; flex-direction: column; align-items: center; margin-right: 2px;">
              <svg id="sticky-hydrogen-gauge-svg" width="126" height="72" viewBox="0 0 140 80" style="display: block;">
                <path id="sticky-hydrogen-gauge-bg" d="M 20 70 A 50 50 0 0 1 120 70" fill="none" stroke="#e0e0e0" stroke-width="12" />
                <path id="sticky-hydrogen-gauge-fill" d="M 20 70 A 50 50 0 0 1 120 70" fill="none" stroke="#00bcd4" stroke-width="12" stroke-linecap="round" stroke-dasharray="157" stroke-dashoffset="157" />
              </svg>
              <div style="display: flex; flex-direction: column; align-items: center; margin-top: -40px;">
                <img src="/icons/newhydro.webp" alt="Hydrogen Icon" style="width:34px;height:34px;object-fit:contain;" />
                <div id="sticky-hydrogen-gauge-percentage" style="font-size: 16px; color: #222; font-weight: bold; text-align:center;">0 %</div>
              </div>
              <div style="margin-top: 2px; font-size: 15px; color: #222; font-weight: 500;">Hydrogen</div>
            </div>
            <!-- Sticky Bar Thermal Gauge -->
            <div id="sticky-thermal-gauge" style="display: flex; flex-direction: column; align-items: center; margin-right: 2px;">
              <svg id="sticky-thermal-gauge-svg" width="126" height="72" viewBox="0 0 140 80" style="display: block;">
                <path id="sticky-thermal-gauge-bg" d="M 20 70 A 50 50 0 0 1 120 70" fill="none" stroke="#e0e0e0" stroke-width="12" />
                <path id="sticky-thermal-gauge-fill" d="M 20 70 A 50 50 0 0 1 120 70" fill="none" stroke="#ff7f50" stroke-width="12" stroke-linecap="round" stroke-dasharray="157" stroke-dashoffset="157" />
              </svg>
              <div style="display: flex; flex-direction: column; align-items: center; margin-top: -40px;">
                <img src="/icons/thermometer.webp" alt="Thermal Icon" style="width:34px;height:34px;object-fit:contain;" />
                <div id="sticky-thermal-gauge-percentage" style="font-size: 16px; color: #222; font-weight: bold; text-align:center;">0 kWh</div>
              </div>
              <div style="margin-top: 2px; font-size: 15px; color: #222;">Thermal</div>
            </div>
            <!-- Sticky Bar Charging Station: Electric -->
            <div id="sticky-charging-electric" style="display: flex; flex-direction: column; align-items: center; margin-right: 2px;">
              <div style="display:flex;flex-direction:column;align-items:center;">
                <img src="/icons/charging-station.webp" alt="Charging Station Electric" style="width:34px;height:34px;object-fit:contain;" />
                <div id="charging-electric-level" style="font-size: 14px;font-weight:bold; color: #222; text-align:center;">0 kWh</div>
              </div>
              <div style="margin-top: 2px; font-size: 13px; color: #222;">EV Station</div>
            </div>
            <!-- Sticky Bar Charging Station: Hydrogen -->
            <div id="sticky-charging-hydrogen" style="display: flex; flex-direction: column; align-items: center; margin-right: 2px;">
              <div style="display:flex;flex-direction:column;align-items:center;">
                <img src="/icons/hydrogenstorage.webp" alt="Charging Station Hydrogen" style="width:34px;height:34px;object-fit:contain;" />
                <div id="charging-hydrogen-level" style="font-size: 14px; font-weight:bold; color: #222; text-align:center;">0 g</div>
              </div>
              <div style="margin-top: 2px; font-size: 13px; color: #222;">H2 Station</div>
            </div>
            <button id="lang-de" class="lang-toggle lang-off">DE</button>
            <button id="lang-en" class="lang-toggle lang-on">EN</button>
            <button id="documentation-btn" style="background:#ffa000;color:#fff;border:none;border-radius:8px;padding:8px 18px;font-size:1em;font-weight:600;box-shadow:0 2px 8px rgba(255,160,0,0.10);cursor:pointer;transition:background 0.2s;">ðŸ“– Documentation</button>
          </div>
        </div>
        <div id="corner-content">



            <!-- Hydrogen Eco System Section -->
            <h2 class="widget-title pretty-header" id="eco-title">Hydrogen Eco System</h2>

            <div class="usecase-flex-row">
              <div class="usecase-panel">
                <h3 id="usecase-title">Select Use Case: </h3>
                <div class="usecase-container">
                  <select id="use-case" class="use-case">
                    <option value="offgrid">Off-Grid Sustainable Home</option>
                    <option value="microgrid">Microgrid for a Remote Village</option>
                    <option value="evcharge">EV Charging Station with Renewable Energy</option>
                    <option value="industrial">Industrial Hydrogen Production Plant</option>
                  </select>
                </div>
                <div id="bullet-points-container"></div>
              </div>
            <div class="quick-manual-panel">
              <div class="how-it-works-panel" id="how-it-works-panel" style="background: #e3f2fd; border: 2px solid #1976d2; border-radius: 10px; padding: 14px; margin-top: 6px; margin-bottom: 6px; box-shadow: 0 2px 8px rgba(25, 118, 210, 0.08);">
                <strong id="how-it-works-title" style="font-size: 1.1em; color: #1976d2;">How it works:</strong><br>
                <ul style="margin-top: 6px; margin-bottom: 0;">
<li>
  The <b>Hydrogen Eco Simulation</b> aims for economic profit by using power generated from photovoltaics,<br> buying electricity at low prices, 
  converting excess electricity to hydrogen (<b>electricity to hydrogen</b>) via an electrolyzer, 
  and <br>converting hydrogen back to electricity (<b>hydrogen back to electricity</b>) via a fuel cell when prices are high.
</li>
<li>Selecting a use case changes the parameters of the machinery.</li>
<li>The application uses geolocation to determine if the selected location is sunny and charges the photovoltaics accordingly.</li>
<li>The electrolyzer operates <b>automatically</b> when battery storage is over 80%.</li>
<li>All parameters can also be adjusted <b>manually</b>.</li>
<li>Electricity can be <b>manually</b> bought and sold at market price in the topmost panel.</li>
                </ul>
                <div style="margin-top:8px;"><em>The simulation uses UTC time.</em></div>
              </div>
            </div>
            </div>
            
            <div class="eco-system-container">
              <div class="eco-item" id="photovoltaik">
                <h3>Photovoltaik</h3>
                <label for="PV-efficiency" id="pv-efficiency-label">PV Efficiency:</label>
                <input
                  type="range"
                  id="PV-efficiency"
                  step="1"
                  min="1"
                  max="100"
                />
                <span id="PV-efficiency-value">20</span>
                <label for="PV-power" id="pv-power-label">Photovoltaik Power:</label>
                <input
                  type="range"
                  id="PV-power"
                  step="1"
                  min="100"
                  max="1000000"
                />
                <span id="PV-power-value">200</span>
                <label for="city-select" id="city-select-label">Select Location:</label>
                <select id="city-select">
                  <option value="Frankfurt">Frankfurt</option>
                  <option value="Sydney">Sydney</option>
                  <option value="New York">New York</option>
                  <option value="Madrid">Madrid</option>
                  <option value="Tokyo">Tokyo</option>
                  <option value="Always Sunny" selected>Always Sunny</option>
                </select>
                <p id="current-location-label">Current Location: <span id="location"></span></p>
                <p id="pv-status-label">PV Status: <span id="sun"></span></p>
                <button id="reset" class="reset-btn">Reset Simulation</button>
              </div>
              <div class="eco-item" id="battery">
                <h3>Battery</h3>
                <p>Battery Level: <span id="battery-level" class="level-highlight">0 </span></p>

                <label for="battery-efficiency">Battery Efficiency:</label>
                <input
                  type="range"
                  id="battery-efficiency"
                  step="1"
                  min="1"
                  max="100"
                />
                <span id="battery-efficiency-value">100</span>
                <label for="battery-capacity">Battery Capacity:</label>
                <input
                  type="range"
                  id="battery-capacity"
                  step="1"
                  min="1"
                  max="10000"
                />
                <span id="battery-capacity-value">10 kWh</span>
                <div style="margin-top:8px;">
                  <span style="color:#333; font-size:0.98em; display:block;">Battery Storage</span>
                  <span id="battery-storage-percentage" class="level-highlight" style="box-shadow: 0 2px 8px rgba(76, 175, 80, 0.08); background: linear-gradient(90deg, #e8f5e9 0%, #c8e6c9 100%); color: #1b5e20; padding: 6px 18px; border-radius: 10px; font-weight: 700; font-size: 1.1em; display:block; margin-top:4px;">0%</span>

                </div>

                                <!-- Simulation Speed Slider -->
                <div id="battery-speed-slider-container" style="margin-top:8px;display:flex;flex-direction:column;align-items:center;">
                  <label for="simulation-speed-slider" style="font-size:0.98em;color:#333;margin-bottom:2px;align-self:flex-start;">Simulation Speed:</label>
                  <input type="range" id="simulation-speed-slider" min="1" max="2" value="2" step="1" style="width:100%;margin-bottom:2px;">
                  <div id="simulation-speed-indicator" style="width:100%;font-size:0.92em;color:#1976d2;margin-top:0px;text-align:left;"></div>
                </div>
              </div>
              <div class="eco-item" id="electrolyzer">
                <h3>Electrolyzer</h3>
                <p>Hydrogen Level: <span id="hydrogen-level" class="hydrogen-highlight">0</span></p>
                <label for="electrolyzer-efficiency"
                  >Electrolyzer Efficiency:</label
                >
                <input
                  type="range"
                  id="electrolyzer-efficiency"
                  step="1"
                  min="1"
                  max="100"
                />
                <span id="electrolyzer-efficiency-value">1</span>
                <label for="electrolyzer-power">Electrolyzer Power:</label>
                <input
                  type="range"
                  id="electrolyzer-power"
                  step="1"
                  min="100"
                  max="1000000"
                />
                <span id="electrolyzer-power-value">200</span>
                <label for="electrolyzer-capacity"
                  >Electrolyzer Capacity:</label
                >
                <input
                  type="range"
                  id="electrolyzer-capacity"
                  step="1"
                  min="100"
                  max="10000"
                />
                <span id="electrolyzer-capacity-value">1000</span>
                <div style="margin-top:8px;">
                  <span style="color:#333; font-size:0.98em; display:block;">Hydrogen Storage</span>
                  <span id="hydrogen-storage-percentage" class="hydrogen-highlight" style="box-shadow: 0 2px 8px rgba(76, 175, 80, 0.08); background: linear-gradient(90deg, #e3f2fd 0%, #b3e5fc 100%); color: #1565c0; padding: 6px 18px; border-radius: 10px; font-weight: 700; font-size: 1.1em; display:block; margin-top:4px;">0%</span>
                  <div class="electrolyzer-controls" style="margin-top:10px;">
                    <button id="convert-to-hydrogen" class="start-btn">Start Electrolyzer</button>
                    <button id="convert-to-hydrogen-stop" class="stop-btn">Stop Electrolyzer</button>
                  </div>
                </div>
              </div>
              <div class="eco-item" id="fuelcell">
                <h3>Fuel Cell</h3>
                <label for="fuelcell-efficiency">Fuelcell Efficiency:</label>
                <input
                  type="range"
                  id="fuelcell-efficiency"
                  step="1"
                  min="1"
                  max="100"
                />
                <span id="fuelcell-efficiency-value">100</span>
                <label for="fuelcell-power">Fuelcell Power:</label>
                <input
                  type="range"
                  id="fuelcell-power"
                  step="1"
                  min="100"
                  max="1000000"
                />
                <span id="fuelcell-power-value">200</span>
                <div class="fuelcell-controls" style="margin-top:10px;">
                  <button id="convert-to-electricity" class="start-btn">Start Fuelcell</button>
                  <button id="convert-to-electricity-stop" class="stop-btn">Stop Fuelcell</button>
                </div>
              </div>

            </div>

            <div id="button-container">
            </div>

            <div class="graph-row" style="display: flex; gap: 32px; align-items: flex-start; justify-content: center; margin-bottom: 24px;">
              <div style="flex: 1; min-width: 320px; max-width: 600px;">
                <h2 class="pretty-header">Battery Storage</h2>
                <canvas id="batteryChart"></canvas>
              </div>
              <div style="flex: 1; min-width: 320px; max-width: 600px;">
                <h2 class="pretty-header">Hydrogen Storage</h2>
                <canvas id="hydrogenChart"></canvas>
              </div>
            </div>
                      <h2 class="pretty-header" id="trading-panel-title" style="margin-bottom:18px;">Trading Panel</h2>
          <div class="trade-panel" style="margin-bottom: 18px; border: 2px solid #1976d2; border-radius: 10px; padding: 12px; background: #f5faff;">
            <div class="money-row" style="display: flex; align-items: center; gap: 8px; margin-bottom: 10px;">
              <span>Account Balance:</span>
              <span id="money" class="money-highlight"></span>
              <span style="margin-left: 16px;">Electricity stored: <span id="battery-level-top" class="level-highlight">0 kWh</span></span>
              <span class="trade-market-price" style="margin-left: 16px;">Current Market Price: <span id="current-market-price-sell"></span> â‚¬/MWh</span>
            </div>
            <div class="trade-row" style="margin-bottom: 8px;">
              <button id="buy-button" class="button buy">Buy Electricity</button>
              <input type="number" id="buy-amount" min="0.1" step="0.1" placeholder="kWh" class="trade-input">
              <button class="trade-increment" data-target="buy-amount" data-inc="1">+1</button>
              <button class="trade-increment" data-target="buy-amount" data-inc="10">+10</button>
              <button class="trade-increment" data-target="buy-amount" data-inc="100">+100</button>
              <button id="reset-buy-amount" class="trade-reset" title="Reset to 0">âŸ²</button>
            </div>
            <div class="trade-row" style="margin-bottom: 8px;">
              <button id="sell-button" class="button sell">Sell Electricity</button>
              <input type="number" id="sell-amount" min="0.1" step="0.1" placeholder="kWh" class="trade-input">
              <button class="trade-increment" data-target="sell-amount" data-inc="1">+1</button>
              <button class="trade-increment" data-target="sell-amount" data-inc="10">+10</button>
              <button class="trade-increment" data-target="sell-amount" data-inc="100">+100</button>
              <button id="reset-sell-amount" class="trade-reset" title="Reset to 0">âŸ²</button>
            </div>
            <div class="trade-row" style="margin-bottom: 8px;">
              <button id="sell-hydrogen-button" class="button sell" style="background:#1976d2; color:#fff;">Sell Hydrogen</button>
              <input type="number" id="sell-hydrogen-amount" min="0.1" step="0.1" placeholder="g" class="trade-input">
              <button class="trade-increment" data-target="sell-hydrogen-amount" data-inc="1">+1</button>
              <button class="trade-increment" data-target="sell-hydrogen-amount" data-inc="10">+10</button>
              <button class="trade-increment" data-target="sell-hydrogen-amount" data-inc="100">+100</button>
              <button id="reset-sell-hydrogen-amount" class="trade-reset" title="Reset to 0">âŸ²</button>
              <span class="trade-market-price" id="latest-hydrogen-price-label" style="margin-left: 16px;">Latest Hydrogen Price: <span id="latest-hydrogen-price">--</span> â‚¬/kg</span>
            </div>
            <div style="height:12px;"></div>
            <div class="trade-row" style="margin-bottom: 8px; flex-direction: column; align-items: flex-start;">
              <button id="show-hydrogen-price-history" class="button" style="background:#ffa000; color:#fff; margin-left:0;">Show More</button>
              <div id="hydrogen-price-history-container" style="display:none; margin-top:10px; width:100%;">
                <canvas id="hydrogenPriceChart" width="400" height="240"></canvas>
              </div>
            </div>


          </div>

          <h2 class="pretty-header" id="wholesale-title" style="margin-top:32px;">Wholesale Price</h2>
          <div class="data-limitation">
          
          </div>
          <!-- Canvas for Chart -->
          <canvas id="myChart" width="400" height="70"></canvas>
          <div id="chart-error" style="display:none; color: #b00020; font-weight: bold; margin-top: 8px;"></div>

          <div id="graph-selector2">
            <h2 id="chart2-title" class="pretty-header">Electricity Consumption</h2>
            <h3>Select Power Generation:</h3>
          
            <div class="checkbox-container">
              <div class="checkbox-group">
                <input type="checkbox" value="browncoal" /> Brown Coal
                <input type="checkbox" value="biomass" /> Biomass
                <input type="checkbox" value="windoffshore" /> Wind Offshore
                <input type="checkbox" value="windonshore" /> Wind Onshore
                <input type="checkbox" value="hydroelectric" /> Hydroelectric
              </div>
              <div class="checkbox-group">

                <input type="checkbox" value="naturalgas" /> Natural Gas
                <input type="checkbox" value="blackcoal" /> Black Coal
                <input type="checkbox" value="photovoltaik" /> Photovoltaik
                <input type="checkbox" value="otherconventional" /> Other Conventional
                <input type="checkbox" value="otherrenewable" /> Other Renewable
              </div>
            </div>

            <div class="dropdown-container">
              <select id="mobile-dropdown">
                <option value="browncoal"> Brown Coal</option>
                <option value="biomass"> Biomass</option>
                <option value="windoffshore"> Wind Offshore</option>
                <option value="windonshore"> Wind Onshore</option>
                <option value="hydroelectric"> Hydroelectric</option>
                <option value="naturalgas"> Natural Gas</option>
                <option value="blackcoal"> Black Coal</option>
                <option value="photovoltaik"> Photovoltaik</option>
                <option value="otherconventional"> Other Conventional</option>
                <option value="otherrenewable"> Other Renewable</option>
              </select>
            </div>
          
            <canvas id="myChart2" width="400" height="85"></canvas>
          </div>
                                    <div class="eco-item" id="consumer">
                <h3>Consumers</h3>
                <div id="consumer-panel-content" style="padding:8px 4px;">
                  <div class="consumer-columns" style="display:flex;gap:12px;align-items:flex-start;">
                    <div id="consumer-panel-left" style="flex:0 0 260px;min-width:180px;"></div>
                    <div id="consumer-panel-right" style="flex:1;"></div>
                  </div>
                </div>
              </div>
            <div style="display:flex;justify-content:center;gap:24px;margin-bottom:32px;">
              <button id="changelogs-btn" style="background:#1976d2;color:#fff;border:none;border-radius:8px;padding:12px 28px;font-size:1.08em;font-weight:500;box-shadow:0 2px 8px rgba(25,118,210,0.10);cursor:pointer;transition:background 0.2s;">
                ðŸ“‹ Changelogs
              </button>
              <button id="feedback-btn" style="background:#43a047;color:#fff;border:none;border-radius:8px;padding:12px 28px;font-size:1.08em;font-weight:500;box-shadow:0 2px 8px rgba(67,160,71,0.10);cursor:pointer;transition:background 0.2s;">
                ðŸ’¬ Report Feedback
              </button>
            </div>
            <!-- Changelogs Modal -->
            <!-- Documentation Modal -->
            <div id="documentation-modal" class="dashboard-modal" style="display:none;">
              <h3 style="margin-top:0;color:#ffa000;">Documentation</h3>
              <div style="max-height:60vh;overflow-y:auto;">
                <strong>Hydrogen Dashboard</strong> is designed to retrieve and visualize power generation and consumption data from the SMARD API. The dashboard provides graphical analysis and enables direct comparison with hydrogen as a fuel source.
                <br><br>
                <strong>Use Case Window:</strong><br>
                The use case window lets you select different real-world scenarios (e.g., Off-Grid Home, Microgrid, EV Charging Station, Industrial Plant). Each use case changes the simulation parameters to reflect typical machinery and energy needs for that scenario.<br><br>
                <strong>Simulation Overview:</strong><br>
                The simulation models a renewable energy system using four main components:
                <ul style="margin-top:4px;margin-bottom:4px;">
                  <li><b>Photovoltaik</b> â€“ Generates electricity from sunlight, charging the battery and powering other components.</li>
                  <li><b>Battery</b> â€“ Stores excess electricity for later use, balances supply and demand.</li>
                  <li><b>Electrolyzer</b> â€“ Converts surplus electricity into hydrogen, which can be stored for long-term energy needs.</li>
                  <li><b>Fuel Cell</b> â€“ Converts stored hydrogen back into electricity when needed, especially when prices are high or solar is unavailable.</li>
                </ul>
                <br>
                <strong>Thermal energy extraction:</strong><br>
                The simulation can recover heat produced as a byâ€‘product from the electrochemical machinery â€” primarily the <b>electrolyzer</b> and the <b>fuel cell</b>. Recoverable heat is derived from each machine's instantaneous throughput and inefficiency: the model computes the machine's energy flow over the current tick, applies its conversion efficiency, and treats the remainder (multiplied by a configurable recoverable fraction and heatâ€‘exchanger efficiency) as recoverable thermal energy. That energy is accumulated in a small thermal storage object (shown in the UI in kWh) up to the configured capacity; the storage also experiences passive losses over time.
                <br>
                <strong>Perâ€‘useâ€‘case thermal capacity & losses:</strong><br>
                By default the thermal storage is initialized to <b>50 kWh</b> and the model applies passive losses configured as <b>1% per hour</b> (the loss fraction is applied proportional to the simulation time step). The UI also provides a computed recommendation for thermal capacity based on the configured machines; that recommendation is clamped to <b>10â€“200 kWh</b> so suggestions stay within the app's UI range.
                <br>
                Suggested guidance for the builtâ€‘in use cases:
                <ul>
                  <li><b>Offâ€‘Grid Home</b> â€” typical battery setting: ~20 kWh. Practical thermal capacity: <b>10â€“50 kWh</b>. A 50 kWh tank can provide domestic hot water for a small household for multiple days or run a 2.2 kW kettle for ~22 hours.</li>
                  <li><b>Microgrid (remote village)</b> â€” battery example: ~500 kWh. Practical thermal capacity: <b>50â€“200 kWh</b>. 200 kWh can cover community heating spikes or provide multiâ€‘home shortâ€‘term heating.</li>
                  <li><b>EV Charging Station</b> â€” station example: ~1,000 kWh battery. Useful thermal capacity: <b>50â€“200 kWh</b>. 200 kWh offsets many small heating loads or service heating events.</li>
                  <li><b>Industrial Plant</b> â€” plant scale is multiâ€‘MW and battery examples in the app are very large (multiâ€‘MWh). The inâ€‘app recommendation is capped at 200 kWh for UI safety; industrial sites often require MWhâ€‘scale thermal stores. You can manually increase `thermalStorage.capacity_kWh` for industrial scenarios but expect passive losses to scale with stored energy.</li>
                </ul>
                <br>
                <br>
                <strong>Graphs:</strong><br>
                The dashboard features interactive graphs that display power generation, consumption, storage levels, and market prices over time. These help you analyze system performance, track energy flows, and compare the impact of different use cases.<br><br>
                <strong>Trading Panel:</strong><br>
                The trading panel allows you to buy or sell electricity based on real-time or simulated market prices. You can manually execute trades, set thresholds for automated trading, and see the effect on your system's storage and finances.<br><br>
                <strong>Tip:</strong> Adjust parameters and switch use cases to explore how different setups affect your energy system's efficiency and profitability.
              </div>
              <button onclick="document.getElementById('documentation-modal').style.display='none'" style="background:#ffa000;color:#fff;border:none;border-radius:6px;padding:8px 18px;font-size:1em;cursor:pointer;">Close</button>
            </div>
            <div id="changelogs-modal" class="dashboard-modal" style="display:none;">
              <h3 style="margin-top:0;color:#1976d2;">Changelogs</h3>
              <div style="margin-bottom:18px;">Latest updates and changes will be listed here.</div>
              <ul style="margin-bottom:18px;">
                <
                <li><b>2025-09-08:</b> Added feedback modal and changelogs.</li>
                <li><b>2025-09-10:</b> Added documentation.</li>
                <li><b>2025-09-16:</b> Hydrogen is now sellable.</li>
                <li><b>2025-09-18:</b> Added language support for German.</li>
                <li><b>2025-09-22:</b> Added realtime hydrogen price updates with graph.</li>
                <li><b>2025-10-04:</b> Visual overhaul of UI, improved gauge visuals, sticky bar/widget consistency, and performance fixes for smoother simulation.</li>
                <li><b>2025-10-08:</b> Added thermal storage support and consumption</li>
              </ul>
              <button onclick="document.getElementById('changelogs-modal').style.display='none'" style="background:#1976d2;color:#fff;border:none;border-radius:6px;padding:8px 18px;font-size:1em;cursor:pointer;">Close</button>
            </div>
            
            <!-- Feedback Modal -->
            <div id="feedback-modal" class="dashboard-modal" style="display:none;">
              <h3 style="margin-top:0;color:#43a047;">Report Feedback</h3>
              <form id="feedback-form" style="display:flex;flex-direction:column;gap:14px;">
                <input type="text" id="feedback-name" name="name" placeholder="Your Name" style="padding:8px 12px;border-radius:6px;border:1px solid #ccc;font-size:1em;" required />
                <textarea id="feedback-text" name="feedback" placeholder="Your Feedback" style="padding:8px 12px;border-radius:6px;border:1px solid #ccc;font-size:1em;min-height:80px;resize:vertical;" required></textarea>
                <button type="submit" style="background:#43a047;color:#fff;border:none;border-radius:6px;padding:10px 22px;font-size:1.08em;font-weight:500;cursor:pointer;">Submit</button>
              </form>
              <button onclick="document.getElementById('feedback-modal').style.display='none'" style="background:#43a047;color:#fff;border:none;border-radius:6px;padding:8px 18px;font-size:1em;cursor:pointer;margin-top:10px;">Close</button>
              <div id="feedback-success" style="display:none;color:#43a047;margin-top:12px;font-weight:500;">Thank you for your feedback!</div>
            </div>
            </div>
            <div id="notification" class="notification">1kW Electricity bought!</div>

          </div>

        </div>
      </div>
    </div>

  </body>
</html>



